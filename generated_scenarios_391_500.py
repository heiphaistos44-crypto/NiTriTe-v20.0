# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ” SCÃ‰NARIOS 391-500 - SÃ‰CURITÃ‰, LOGICIELS, GAMING, STREAMING & OVERCLOCKING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GÃ©nÃ©rÃ© automatiquement - 110 scÃ©narios Ã— 10 Ã©tapes = 1100 Ã©tapes dÃ©taillÃ©es
# Langue: 100% franÃ§ais conversationnel
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def handle_scenarios_391_500(msg_lower):
    """
    Traite les scÃ©narios 391-500 avec dÃ©tails complets
    Retourne une chaÃ®ne de rÃ©ponse formatÃ©e
    """
    body_parts = []

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # CATÃ‰GORIE 12: SÃ‰CURITÃ‰ & ANTIVIRUS (391-420)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    # ğŸ›¡ï¸ #391 VIRUS DÃ‰TECTÃ‰
    if any(word in msg_lower for word in ["virus dÃ©tectÃ©", "malware detection", "malveillant", "infection"]):
        body_parts.append("ğŸ›¡ï¸ #391 VIRUS DÃ‰TECTÃ‰ - GUIDE COMPLET DE SUPPRESSION")
        body_parts.append("\nProblÃ¨me: Ton Windows a signalÃ© un virus ou un malware! C'est l'une des situations les plus graves. Pas de panique, c'est souvent gÃ©rable.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Isoler l'ordinateur**")
        body_parts.append("DÃ©connecte ton PC de l'internet immÃ©diatement (dÃ©brancher cÃ¢ble Ethernet ou dÃ©sactiver WiFi). Ã‡a empÃªche le malware de se propager ou de tÃ©lÃ©charger d'autres trucs. Ne visite AUCUN site web tant que tu n'as pas nettoyÃ©.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Identifier le malware avec Windows Defender**")
        body_parts.append("Ouvre 'SÃ©curitÃ© Windows' (tapez 'Defender' dans la barre de recherche). Va dans 'Gestion des menaces' â†’ 'Historique de la menace'. Note EXACTEMENT le nom du malware (ex: Trojan.Win32.Generic!C2 ou Adware.YourSearchHelper). Cet identifiant est crucial.\n")
        body_parts.append("**âš¡ Ã‰tape 3: RedÃ©marrer en Mode Sans Ã‰chec avec mise en rÃ©seau**")
        body_parts.append("Appuie sur Windows + R, tape 'msconfig', Onglet 'Boot' â†’ coche 'Mode sans Ã©chec' + 'RÃ©seau' â†’ OK. RedÃ©marre. En Mode Sans Ã‰chec, plein de malwares se dÃ©sactivent. Tu dois garder le rÃ©seau pour tÃ©lÃ©charger les outils de suppression.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Lancer un scan complet Windows Defender**")
        body_parts.append("En Mode Sans Ã‰chec, ouvre SÃ©curitÃ© Windows â†’ 'Analyse' â†’ 'Analyse complÃ¨te'. Ã‡a va checker tout ton disque dur (peut prendre 1-3 heures). Laisse-le aller jusqu'au bout. Note EXACTEMENT les fichiers dÃ©tectÃ©s.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Utiliser Malwarebytes anti-malware**")
        body_parts.append("Toujours en Mode Sans Ã‰chec, tÃ©lÃ©charge Malwarebytes depuis malwarebytes.com avec un autre PC (clÃ© USB) ou depuis le navigateur. Installe + lance scan complet. Malwarebytes dÃ©tecte des trucs que Defender rate (PUPs, adwares). Laisse-le nettoyer tout.\n")
        body_parts.append("**âš¡ Ã‰tape 6: Lancer HitmanPro (approche alternative)**")
        body_parts.append("Si Malwarebytes rate des choses, utilise HitmanPro (logiciel cloud-based). TÃ©lÃ©charge depuis hitmanpro.com, lance scan cloud. HitmanPro scan en temps rÃ©el avec une BD malware ultra Ã  jour. Supprime tout ce qu'il trouve.\n")
        body_parts.append("**âš¡ Ã‰tape 7: VÃ©rifier les processus suspectes et les services**")
        body_parts.append("Ouvre Task Manager (Ctrl+Shift+Esc) â†’ onglet 'Processus'. Cherche les .exe suspects avec des noms bizarres (random characters, noms qui ressemblent Ã  des trucs lÃ©git comme 'áºµervice.exe' avec caractÃ¨res Ã©tranges). Clique-droit â†’ 'Ouvrir l'emplacement du fichier' â†’ note le chemin (ex: C:\\Users\\Temp\\malware.exe au lieu de C:\\Windows\\System32\\).\n")
        body_parts.append("**âš¡ Ã‰tape 8: Nettoyer le registre et les dossiers temporaires**")
        body_parts.append("TÃ©lÃ©charge CCleaner (ccleaner.com). Onglet 'Nettoyage' â†’ scan. Ne supprime PAS les entrÃ©es registre critiques. Mieux: utilise juste la fonction 'Nettoyeur de registre' basique. Supprime aussi les fichiers dans C:\\Windows\\Temp et C:\\Users\\%username%\\AppData\\Local\\Temp.\n")
        body_parts.append("**âš¡ Ã‰tape 9: RÃ©initialiser les paramÃ¨tres du navigateur et des extensions**")
        body_parts.append("Beaucoup de malwares installent des extensions de navigateur qui redirigent les recherches. Ouvre Chrome/Firefox/Edge â†’ ParamÃ¨tres â†’ Extensions â†’ supprime TOUT ce que tu ne reconnais pas. RÃ©initialise la page d'accueil et le moteur de recherche par dÃ©faut vers Google officiel.\n")
        body_parts.append("**âš¡ Ã‰tape 10: CrÃ©er une partition de rÃ©cupÃ©ration et tester**")
        body_parts.append("Si l'infection persiste aprÃ¨s tout Ã§a, la seule solution fiable est une rÃ©installation Windows complÃ¨te. Sauvegarde tes donnÃ©es (pas le C:\\, mais les dossiers importants sur un disque externe). Utilise l'outil CrÃ©ation de mÃ©dia Windows (mediactreation tool.com) pour crÃ©er une clÃ© USB d'installation. Format le disque C: et rÃ©installe Windows 10/11 propre. Ensuite restaure juste tes donnÃ©es, pas les programmes.")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #392 PROTECTION RANSOMWARE
    if any(word in msg_lower for word in ["ransomware", "ranÃ§ongiciel", "fichiers chiffrÃ©s", "cryptÃ©", "locked files"]):
        body_parts.append("ğŸ›¡ï¸ #392 PROTECTION RANSOMWARE - PRÃ‰VENTION & RÃ‰CUPÃ‰RATION")
        body_parts.append("\nProblÃ¨me: Le ransomware chiffre tes fichiers et demande une ranÃ§on. C'est du sÃ©rieux! Mais la prÃ©vention peut tout Ã©viter.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Comprendre comment le ransomware fonctionne**")
        body_parts.append("Le ransomware s'installe via email malveillant, tÃ©lÃ©chargement suspect, ou exploits. Il chiffre TOUS tes fichiers personnels (.docx, .jpg, .mp4, etc.) avec une clÃ© de 2048-bit RSA. Sans la clÃ© privÃ©e, c'est mathÃ©matiquement impossible Ã  dÃ©crypter (mÃªme une ranÃ§on de 100 000â‚¬ ne garantit pas la clÃ©). Prevention > cure.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Activer 'AccÃ¨s contrÃ´lÃ© aux dossiers' Windows Defender**")
        body_parts.append("Ouvre SÃ©curitÃ© Windows â†’ 'Gestion des menaces' â†’ 'Gestion des menaces par ransomware' â†’ 'AccÃ¨s contrÃ´lÃ© aux dossiers' â†’ ActivÃ©. Ã‡a bloque ANY processus inconnu d'accÃ©der Ã  tes dossiers Documents, TÃ©lÃ©chargements, Bureau, etc. Le ransomware aura besoin de permission explicite. MUST-HAVE.\n")
        body_parts.append("**âš¡ Ã‰tape 3: CrÃ©er des sauvegardes hors-ligne (offline backup)**")
        body_parts.append("Le ransomware attaque aussi les sauvegardes cloud (OneDrive, Google Drive). Utilise une solution offline: accroche un disque USB external une fois par semaine, sauvegarde tes dossiers importants MANUELLEMENT. DÃ©branche-le aprÃ¨s. Comme Ã§a, mÃªme si ton PC est infectÃ©, tes backups restent sÃ»rs.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Configurer Windows Backup pour System Image**")
        body_parts.append("Windows 11: ParamÃ¨tres â†’ 'SystÃ¨me' â†’ 'Sauvegarde' â†’ 'Sauvegarder maintenant'. CrÃ©e une image systÃ¨me complÃ¨te sur un disque externe. Sauvegarde aussi l'historique des fichiers (copie chaque fichier modifiÃ©). Si ransomware attaque, tu peux restaurer Ã  partir de cette image.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Utiliser le ContrÃ´le d'AccÃ¨s BasÃ© sur les RÃ´les (RBAC)**")
        body_parts.append("Restreins les droits admin. Utilise un compte standard au quotidien, pas admin. Quand tu dois installer un programme, entre le mot de passe admin. Ã‡a limite les dÃ©gÃ¢ts: si tu cliques sur un lien malveillant, le malware n'a accÃ¨s qu'aux fichiers du compte standard, pas Ã  C:\\Windows ou C:\\Program Files.\n")
        body_parts.append("**âš¡ Ã‰tape 6: Mettre Ã  jour Windows et les applications RELIGIEUSEMENT**")
        body_parts.append("Les ransomware exploitent les failles de sÃ©curitÃ© (CVEs). Mets Ã  jour Windows (Windows Update auto chaque mardi 'Patch Tuesday'). Mets Ã  jour aussi les apps: Adobe Reader, Java, navigateurs. Chaque faille fermÃ©e = vecteur d'attaque en moins. Les anciens OS sans patch? Primes au ransomware.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Ã‰duquer sur les emails malveillants**")
        body_parts.append("Les ransomware arrivent surtout via emails de phishing. Ne clique JAMAIS sur les attachements suspects (surtout .exe, .scr, .bat). VÃ©rifie l'adresse email: 'paypal.fr@random-domain.com' c'est faux! Si un email dit 'Urgence: Confirme ton compte', c'est du phishing. Quand en doute, appelle la boÃ®te directement.\n")
        body_parts.append("**âš¡ Ã‰tape 8: Configurer un pare-feu restrictif (UFW/Windows Firewall Pro)**")
        body_parts.append("Windows Firewall par dÃ©faut allow outbound. Config avancÃ©e: Windows Defender Firewall with Advanced Security â†’ RÃ¨gles de trafic sortant â†’ dÃ©faut sur 'Bloc'. Puis whiteliste SEULEMENT les apps que tu utilises (navigateur, Steam, Discord). Ã‡a ralentit le ransomware qui essaie de 'call home' (se connecter Ã  un serveur C&C).\n")
        body_parts.append("**âš¡ Ã‰tape 9: Monitorer l'activitÃ© disque et la crÃ©ation de fichiers**")
        body_parts.append("Le ransomware crÃ©e des MILLIONS de fichiers en quelques secondes (chiffrement). Utilise Process Monitor (Sysinternals) ou Autoruns pour voir exactement quel .exe crÃ©e des fichiers. Si tu vois un processus random crÃ©er 10 000 fichiers par seconde, c'est suspecte. Tue-le immÃ©diatement et scan.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Avoir un plan d'action si infectÃ©: Disconnecter immÃ©diatement**")
        body_parts.append("Si tu soupÃ§onnes une infection ransomware (fichiers renommÃ©s en .lock, .id-[UUID], messages de ranÃ§on): DÃ‰BRANCHE LA PRISE TOUT DE SUITE! Pas de shutdown propre (Ã§a peut terminer le chiffrement). DÃ©branch physiquement. Entravers l'attaque du serveur C&C. Reste une chance que tes fichiers ne soient que PARTIELLEMENT chiffrÃ©s.")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #393 TROJAN HORSE REMOVAL
    if any(word in msg_lower for word in ["trojan", "cheval de troie", "trojan horse", "backdoor"]):
        body_parts.append("ğŸ›¡ï¸ #393 TROJAN HORSE REMOVAL - SUPPRESSION COMPLÃˆTE")
        body_parts.append("\nProblÃ¨me: Un Trojan est un malware qui se fait passer pour un logiciel lÃ©gitime mais qui fait du mal en arriÃ¨re-plan.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Identifier le Trojan spÃ©cifique**")
        body_parts.append("Windows Defender â†’ 'Historique de la menace' â†’ note le nom exact (ex: Trojan.Win32.Emotet!A2, Trojan.Generic.15023). Chaque trojan a un comportement diffÃ©rent. Certains volent les mots de passe, d'autres installent des backdoors pour l'accÃ¨s distant, d'autres tÃ©lÃ©chargent d'autres malwares.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Googler le nom du Trojan + 'removal'**")
        body_parts.append("Sur un autre PC sain, cherche '[nom exact du trojan] removal'. Des sites comme Malwarebytes.com et HitmanPro.com ont des guides dÃ©taillÃ©s. Ils expliquent: quels fichiers supprimer, quelles entrÃ©es registre nettoyer, quels processus terminer. Utilise UNIQUEMENT des sources fiables (Kaspersky, Symantec, F-Secure).\n")
        body_parts.append("**âš¡ Ã‰tape 3: Booter en Mode Sans Ã‰chec + RÃ©seau**")
        body_parts.append("En Mode Normal, le Trojan peut se lancer au dÃ©marrage et se dÃ©fendre. En Mode Sans Ã‰chec, presque tous les drivers et services non-essentiels se dÃ©sactivent. Le trojan devient inoffensif. Tap Windows+R â†’ msconfig â†’ Boot â†’ Safe Mode + Network â†’ RedÃ©marrage.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Lancer Malwarebytes + scan complet**")
        body_parts.append("Installe/lance Malwarebytes (offline installer sur USB si nÃ©cessaire). Onglet 'Scan' â†’ 'Scan Complet'. Scan tous les fichiers, registre, mÃ©moire RAM. Attend 1-2h. Malwarebytes est excellent pour les trojans car il scanne aussi la mÃ©moire (RAM) oÃ¹ le trojan se cache.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Nettoyer le registre avec CCleaner**")
        body_parts.append("AprÃ¨s Malwarebytes, utilise CCleaner â†’ 'Registre' â†’ 'Scanner' â†’ identifie les entrÃ©es de l'exe du trojan. Supprime. Cherche aussi les chemins bizarres: HKLM\\Software\\Trojan_name\\. Supprime les clÃ©s entiÃ¨res. ATTENTION: ne casse pas le registre Windows! Fais un backup d'abord (Fichier â†’ Exporter).\n")
        body_parts.append("**âš¡ Ã‰tape 6: DÃ©sactiver les services malveillants au dÃ©marrage**")
        body_parts.append("Tapez 'services.msc' â†’ cherche les services inconnus lancÃ©s au boot. Clique-droit â†’ PropriÃ©tÃ©s â†’ Type de dÃ©marrage â†’ 'DÃ©sactivÃ©'. Les trojans souvent crÃ©ent des services Windows fake pour survivre aux redÃ©marrages. Services suspects: RandomName.exe Service, FakeName_Svc, etc.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Supprimer les chemins de fichiers du Trojan manuellement**")
        body_parts.append("Ouvre File Explorer â†’ affiche les fichiers cachÃ©s (View â†’ Hidden items). Cherche les dossiers du Trojan: gÃ©nÃ©ralement C:\\Users\\%username%\\AppData\\Local\\Temp ou C:\\ProgramData\\[TrojanName]. Supprime TOUT le dossier. Si accÃ¨s refusÃ©, rÃ©initie les permissions: clique-droit â†’ PropriÃ©tÃ©s â†’ SÃ©curitÃ© â†’ AvancÃ© â†’ Modifier le propriÃ©taire â†’ ta session utilisateur.\n")
        body_parts.append("**âš¡ Ã‰tape 8: VÃ©rifier les fichiers hÃ´te (hosts file) et les connexions rÃ©seau**")
        body_parts.append("Les trojans modifient souvent C:\\Windows\\System32\\drivers\\etc\\hosts pour rediriger les sites web. Ouvre hosts (Notepad as Admin) â†’ cherche les lignes bizarres (ex: 127.0.0.1 google.com si c'est suspect). Supprime. Aussi, tapez 'netstat -an' dans Command Prompt pour voir les connexions rÃ©seau actives. Note les IP suspectes (check sur abuseipdb.com).\n")
        body_parts.append("**âš¡ Ã‰tape 9: Utiliser des scanners en ligne spÃ©cialisÃ©s**")
        body_parts.append("AprÃ¨s tout Ã§a, utilise VirusTotal.com: upload les fichiers suspects (avec le hash si possible, pas le fichier complet). VirusTotal scanne avec 70+ engines antivirus diffÃ©rents. Si 50+ engines le dÃ©tectent comme malware, c'est du sÃ©rieux. Note exactement quel moteur le dÃ©tecte en tant que Trojan.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Rester vigilant post-suppression + monitoring**")
        body_parts.append("MÃªme aprÃ¨s suppression, le trojan peut avoir copiÃ© certains fichiers ou installÃ© d'autres backdoors cachÃ©s. Pendant 2-3 semaines, utilise Autoruns (sysinternals.com) pour checker TOUS les programmes au dÃ©marrage. Lance des scans Malwarebytes une fois par semaine. Change tes mots de passe pour TOUS les comptes sensibles (email, banque, rÃ©seaux sociaux).")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #394 ROOTKIT DETECTION GMER
    if any(word in msg_lower for word in ["rootkit", "gmer", "kernel mode", "systÃ¨me infection"]):
        body_parts.append("ğŸ›¡ï¸ #394 ROOTKIT DETECTION & GMER GUIDE")
        body_parts.append("\nProblÃ¨me: Un rootkit s'installe au niveau kernel (cÅ“ur du systÃ¨me) et se cache des outils normaux.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Comprendre la gravitÃ© d'un Rootkit**")
        body_parts.append("Un rootkit a accÃ¨s TOTAL au systÃ¨me. Il peut: spy sur tout ce que tu fais, intercepter les mots de passe, modifier les fichiers systÃ¨me, activer une webcam, etc. Les rootkits se cachent des antivirus normaux car ils s'exÃ©cutent Ã  la mÃªme permission que le kernel. C'est difficile de s'en dÃ©barrasser.\n")
        body_parts.append("**âš¡ Ã‰tape 2: TÃ©lÃ©charger GMER sur un PC sain**")
        body_parts.append("GMER est un outil spÃ©cialisÃ© dans la dÃ©tection de rootkits. TÃ©lÃ©charge depuis gmer.net sur un PC PROPRE (ou via USB). GMER scanne spÃ©cifiquement le kernel, les drivers, les processus cachÃ©s. L'antivirus normal passe Ã  cÃ´tÃ©, mais GMER les voit. Version actuelle: GMER 2.5 (mise Ã  jour 2023).\n")
        body_parts.append("**âš¡ Ã‰tape 3: Booter en Mode Sans Ã‰chec pour lancer GMER**")
        body_parts.append("Les rootkits se protÃ¨gent en Mode Normal. RedÃ©marre en Mode Sans Ã‰chec (Windows+R â†’ msconfig â†’ Boot tab â†’ Safe Mode â†’ OK). En Mode Sans Ã‰chec, les drivers suspects sont pas chargÃ©s, et GMER peut mieux voir les anomalies du kernel.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Lancer le scan GMER complet**")
        body_parts.append("ExÃ©cute GMER.exe â†’ Clique sur le root folder (C:) â†’ Appuie sur 'Scan' (le bouton scanning). Coche les cases: 'Processes', 'Drivers', 'SSDT', 'IAT/EAT', 'Hosts', 'Services'. ATTEND! Ã‡a peut prendre 30-60 minutes. GMER scanne chaque fonction du kernel pour trouver du code injectÃ©.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Analyser les rÃ©sultats GMER**")
        body_parts.append("GMER affiche les anomalies en rouge. Focus sur: 'Rootkit.Gen' en rouge = BAD. Les SSDT (System Service Descriptor Table) modifiÃ©es = processus kernel hookÃ©s par un rootkit. Les 'Drivers inconnus' = potentiel rootkit. Les 'Services' avec chemins bizarres (ex: C:\\Temp\\random.sys au lieu de C:\\Windows\\System32\\drivers). Note EXACTEMENT les noms et chemins.\n")
        body_parts.append("**âš¡ Ã‰tape 6: Utiliser Autoruns pour identifier les points de dÃ©marrage**")
        body_parts.append("Autoruns (sysinternals.com) affiche TOUS les programmes qui se lancent au dÃ©marrage. Onglets: Logon, Services, Drivers, etc. Le rootkit aura probablement un point de dÃ©marrage. Cherche les entrÃ©es bizarres avec des noms random ou des chemins suspects. Clique-droit â†’ 'Search Online' pour vÃ©rifier si c'est bon ou malveillant.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Utiliser Kaspersky Rescue Disk pour nettoyer**")
        body_parts.append("Si GMER confirme un rootkit, utilise Kaspersky Rescue Disk. CrÃ©e une clÃ© USB bootable sur un autre PC. RedÃ©marre depuis la clÃ©. Kaspersky Rescue scanne AVANT que Windows charge (pre-OS environment), donc le rootkit peut pas se dÃ©fendre. Laisse-le nettoyer. C'est trÃ¨s efficace pour les rootkits kernel.\n")
        body_parts.append("**âš¡ Ã‰tape 8: VÃ©rifier l'intÃ©gritÃ© des fichiers systÃ¨me avec SFC**")
        body_parts.append("AprÃ¨s nettoyage, utilise 'sfc /scannow' (System File Checker). Ouvre Command Prompt as Admin â†’ tape 'sfc /scannow'. SFC scanne les fichiers systÃ¨me Windows et les rÃ©pare s'ils sont corrompus ou modifiÃ©s par un rootkit. Peut prendre 30 min. Besoin du disque d'installation Windows si fichiers sont manquants.\n")
        body_parts.append("**âš¡ Ã‰tape 9: Analyser les fichiers suspects avec VirusTotal**")
        body_parts.append("Pour chaque fichier suspect que GMER a trouvÃ©, upload-le sur VirusTotal.com. Recherche le hash SHA256 du fichier (clique-droit â†’ Properties â†’ Digital Signatures ou utilise 'certutil -hashfile' en Command Prompt). Si 40+ engines l'identifient comme rootkit, c'est confirme.\n")
        body_parts.append("**âš¡ Ã‰tape 10: RÃ©installation Windows si le rootkit persiste**")
        body_parts.append("Les rootkits kernel-mode sont TRÃˆS difficiles Ã  Ã©liminer complÃ¨tement. MÃªme aprÃ¨s tous ces Ã©tapes, tu peux pas Ãªtre 100% sÃ»r que c'est parti. Solution fiable: rÃ©installe Windows propre. Sauvegarde les data personnelles sur disque externe. CrÃ© une clÃ© d'installation Windows (mediactreation tool). Format C: et installe fresh. Seule vraie garantie.")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #395 ADWARE PUP REMOVAL
    if any(word in msg_lower for word in ["adware", "pup", "pub intrusive", "adware removal", "potentially unwanted"]):
        body_parts.append("ğŸ›¡ï¸ #395 ADWARE & PUP (POTENTIALLY UNWANTED PROGRAMS) REMOVAL")
        body_parts.append("\nProblÃ¨me: Des tonnes de pub pop-up, la page d'accueil change sans cesse, des barres de recherche bizarres partout.\n")
        body_parts.append("**âš¡ Ã‰tape 1: DiffÃ©rencier Adware vs PUP vs Malware**")
        body_parts.append("Adware: affiche juste des pubs, pas vraiment dangereux mais chiant. PUP (Potentially Unwanted Program): logiciel qu'on a 'accidentellement' installÃ© (bundleware). Malware: clairement nÃ©faste. Les trois commencent comme Ã§a: tu tÃ©lÃ©charges un 'logiciel gratuit', mais il inclut aussi de l'adware/PUP cachÃ© dans les coches de l'installation.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Checker l'historique d'installation**")
        body_parts.append("VA vÃ©rifier QUAND l'adware a commencÃ©. Regarde les popups: 'MySearchBar', 'SearchSafe', 'Delta Search', 'Conduit Toolbar', etc. Ã‡a te donne des indices. Ouvre 'Panneau de Configuration' â†’ 'Programmes et FonctionnalitÃ©s', trie par date d'installation. Quels programmes ont Ã©tÃ© installÃ©s quand les popups ont commencÃ©?\n")
        body_parts.append("**âš¡ Ã‰tape 3: DÃ©sinstaller les programmes suspects (Uninstall)**")
        body_parts.append("Panneau de Configuration â†’ Programmes et FonctionnalitÃ©s. Cherche les noms bizarres ou que tu ne reconnais pas: 'MySearchBar', 'SearchSafe', 'BrowserAssistant', 'Optimizer Pro', 'PureSearch', etc. Clique-droit â†’ DÃ©sinstaller. Beaucoup d'adware essayent de bloquer la dÃ©sinstallation (popup 'Are you sure?'). Clique Oui. Si impossible, essaie AdwCleaner Ã  l'Ã‰tape 5.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Nettoyer les extensions de navigateur**")
        body_parts.append("Chrome: ParamÃ¨tres â†’ Extensions â†’ supprime TOUT ce que tu reconnais pas (surtout si le nom est vague genre 'Web Helper', 'Power Download', 'App Optimizer'). Firefox: ComplÃ©ments â†’ Extensions â†’ mÃªme chose. Edge: ParamÃ¨tres â†’ Extensions â†’ mÃªme chose. AprÃ¨s, rÃ©initialise la page de dÃ©marrage: paramÃ¨tres â†’ 'Ã€ l'ouverture' â†’ 'Ouvrir une page spÃ©cifique' â†’ choisis Google ou ta page perso.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Utiliser AdwCleaner anti-adware**")
        body_parts.append("TÃ©lÃ©charge AdwCleaner gratuitement depuis toolslib.net (c'est l'outil officiel). ExÃ©cute-le â†’ 'Scan'. AdwCleaner scanne spÃ©cifiquement pour adware, PUP, extensions de navigateur bizarres, fichiers temporaires. Attends le scan (quelques min). Puis clique 'Nettoyer'. AdwCleaner va dÃ©sinstaller/supprimer tout l'adware automatiquement.\n")
        body_parts.append("**âš¡ Ã‰tape 6: Lancer Malwarebytes pour scanner les rÃ©sidus**")
        body_parts.append("MÃªme aprÃ¨s AdwCleaner, il peut rester des fichiers orphelins. Lance Malwarebytes â†’ 'Scan Complet'. Malwarebytes a une BD spÃ©cialisÃ©e pour l'adware. Attend le scan (~1h). Supprime tout ce qui est dÃ©tectÃ©. RedÃ©marre aprÃ¨s.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Nettoyer les fichiers temporaires et le cache**")
        body_parts.append("Utilise CCleaner â†’ onglet 'Nettoyage' â†’ scan. CCleaner supprime les fichiers temporaires (souvent oÃ¹ l'adware se cache), le cache du navigateur, les cookies (rÃ©initialise les sites 'malveillants'). Coche 'Fichiers temporaires', 'Dossier Temp', 'Cache du navigateur'. Supprime tout. Puis onglet 'Registre' â†’ scan & nettoie les entrÃ©es orphelines.\n")
        body_parts.append("**âš¡ Ã‰tape 8: VÃ©rifier les fichiers hosts (redirection DNS)**")
        body_parts.append("L'adware modifie souvent C:\\Windows\\System32\\drivers\\etc\\hosts pour te rediriger vers des sites malveillants. Ouvre le fichier 'hosts' (Notepad as Admin): clique-droit sur Bloc-Notes â†’ 'ExÃ©cuter en tant qu'administrateur' â†’ File â†’ Open â†’ C:\\Windows\\System32\\drivers\\etc â†’ change le type de fichier en 'All Files' â†’ sÃ©lectionne 'hosts'. Cherche les lignes bizarres qui redirigent google.com, facebook.com, etc. vers des IP bizarres. Supprime-les.\n")
        body_parts.append("**âš¡ Ã‰tape 9: RÃ©initialiser les paramÃ¨tres du navigateur Ã  zÃ©ro**")
        body_parts.append("Chrome: ParamÃ¨tres â†’ AvancÃ© â†’ 'RÃ©initialiser les paramÃ¨tres aux valeurs par dÃ©faut'. Firefox: Aide â†’ Information de dÃ©pannage â†’ 'RÃ©parer Firefox'. Edge: ParamÃ¨tres â†’ 'RÃ©initialiser les paramÃ¨tres'. Ã‡a supprime TOUTES les extensions, thÃ¨mes, pages de dÃ©marrage personnalisÃ©es. Tu vas perdre tes sauvegardes de mots de passe SAUF si tu les as synchronisÃ©s.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Installer une protection anti-adware future**")
        body_parts.append("Pour pas rÃ©installer l'adware: ActivÃ© uBlock Origin (extension bloqueur de pubs fiable). Ã‰vite les sites de torrents et tÃ©lÃ©chargement illÃ©gal (souvent bundlÃ©s avec adware). Quand tu tÃ©lÃ©charges, DÃ‰DOCHE TOUS les coches 'Installation personnalisÃ©e' â†’ dÃ©tech tout ce qui est adware-y. Fais des scans Malwarebytes une fois par mois preventif. Et ne tÃ©lÃ©charge JAMAIS depuis cnet.com ou softonic.com (bundleware).")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #396 BROWSER HIJACKER REDIRECT
    if any(word in msg_lower for word in ["browser hijacker", "hijack", "redirection navigateur", "page d'accueil"]):
        body_parts.append("ğŸ›¡ï¸ #396 BROWSER HIJACKER REDIRECTION - CLEANUP COMPLET")
        body_parts.append("\nProblÃ¨me: Tes recherches Google se redirigent vers un moteur de recherche piratÃ©. La page d'accueil est 'SearchSafe' ou similaire au lieu de Google.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Identifier le hijacker exactement**")
        body_parts.append("Ouvre ton navigateur â†’ regarde l'URL de la page de dÃ©marrage. Si tu tapes dans la barre adresse 'google.com', Ã§a te redirige vers quoi? Note l'URL exacte (ex: mysearch.com, delta-search.com). Note aussi le nom de la 'toolbar' s'il y en a une. Ã‡a va t'aider Ã  identifier exactement quel malware c'est.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Fermer TOUS les navigateurs**")
        body_parts.append("Ferme Chrome, Firefox, Edge, Safari complÃ¨tement (ferme aussi les background apps: Task Manager â†’ DÃ©tails â†’ termine chrome.exe, firefox.exe, msedge.exe). Le hijacker modifie les fichiers de config du navigateur. Tu dois vraiment tous les fermer pour faire les modifs.\n")
        body_parts.append("**âš¡ Ã‰tape 3: VÃ©rifier les paramÃ¨tres de proxy Windows**")
        body_parts.append("Panneau de Configuration â†’ AccÃ¨s rÃ©seau et partage â†’ Options Internet â†’ onglet 'Connexions' â†’ 'ParamÃ¨tres du rÃ©seau'. Cherche un proxy actif que tu n'as pas config. Si proxy est dÃ©fini sur quelque chose comme '192.168.1.x:8080' ou un hostname random, c'est le hijacker qui l'a installÃ©. DÃ©tech 'Utiliser un serveur proxy' ou supprime l'adresse. Clique OK.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Nettoyer les raccourcis du navigateur (Target)**")
        body_parts.append("Clique-droit sur l'icÃ´ne de Chrome/Firefox sur le Bureau â†’ PropriÃ©tÃ©s â†’ onglet 'Raccourci' â†’ field 'Cible'. Cherche des paramÃ¨tres bizarres comme '--homepage=http://malicious-site.com'. Supprime tout aprÃ¨s le .exe (garde juste 'C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe'). Clique OK. Refais Ã§a pour tous les navigateurs.\n")
        body_parts.append("**âš¡ Ã‰tape 5: RÃ©initialiser les paramÃ¨tres de navigateur**")
        body_parts.append("Chrome: ParamÃ¨tres â†’ AvancÃ© â†’ 'RÃ©initialiser les paramÃ¨tres aux valeurs par dÃ©faut' â†’ 'RÃ©initialiser'. Firefox: Aide â†’ 'Information de dÃ©pannage' â†’ 'RÃ©parer Firefox'. Edge: ParamÃ¨tres â†’ 'RÃ©initialiser les paramÃ¨tres'. Ã‡a rÃ©initialise la page de dÃ©marrage, la page de recherche, les extensions, etc. aux valeurs par dÃ©faut.\n")
        body_parts.append("**âš¡ Ã‰tape 6: Supprimer les profils de navigateur suspects**")
        body_parts.append("Parfois, le hijacker crÃ©e un nouveau profil de navigateur avec ses paramÃ¨tres dedans. Chrome: ParamÃ¨tres â†’ 'Personnes' â†’ cherche les profils que tu ne reconnais pas. Clique sur le menu (3 points) du profil â†’ 'Supprimer'. Firefox: ouvre about:profiles â†’ 'Root Directory' de chaque profil â†’ supprime les dossiers 'Profile' suspects dans C:\\Users\\%username%\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Utiliser Junkware Removal Tool (JRT)**")
        body_parts.append("TÃ©lÃ©charge JRT depuis malwarebytes.com â†’ exÃ©cute en admin. JRT scanne spÃ©cifiquement pour les hijackers, les toolbars, les extensions bizarres. Clique 'Scan'. Attends. Puis 'Remove'. JRT va nettoyer les rÃ©sidus du hijacker.\n")
        body_parts.append("**âš¡ Ã‰tape 8: VÃ©rifier le fichier hosts**")
        body_parts.append("Ouvre Notepad en admin â†’ File â†’ Open â†’ C:\\Windows\\System32\\drivers\\etc\\hosts (change 'Text Files' en 'All Files'). Cherche les lignes qui redirigent google.com vers d'autres IPs (ex: '127.0.0.1 google.com'). Le hijacker les utilise pour bloquer l'accÃ¨s Ã  Google. Supprime ces lignes. Sauvegarde.\n")
        body_parts.append("**âš¡ Ã‰tape 9: Scanner avec Malwarebytes**")
        body_parts.append("AprÃ¨s tout Ã§a, lance Malwarebytes â†’ 'Scan Complet' â†’ attends 1-2h. Malwarebytes va dÃ©tecter le vrai executable du hijacker (gÃ©nÃ©ralement cachÃ© dans AppData\\Local\\Temp ou AppData\\Roaming). Supprime-le.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Tester et vÃ©rifier**")
        body_parts.append("RedÃ©marre. Ouvre Chrome â†’ va sur google.com. C'est bon? Ã‡a te redirige toujours? Si oui, crÃ©e un nouveau profil Chrome: ParamÃ¨tres â†’ 'Personnes' â†’ 'Ajouter une personne' â†’ utilise ce nouveau profil. Souvent, le vieux profil Ã©tait tellement corrompu que seul un nouveau le rÃ¨gle. Ou, rÃ©installe complÃ¨tement le navigateur (dÃ©sinstalle + rÃ©installe).")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #397 CRYPTOMINER MALWARE
    if any(word in msg_lower for word in ["cryptominer", "crypto mining", "cpu 100%", "crypto malware", "xmrig", "monero"]):
        body_parts.append("ğŸ›¡ï¸ #397 CRYPTOMINER MALWARE CPU 100% DETECTION & REMOVAL")
        body_parts.append("\nProblÃ¨me: Ton CPU cuit Ã  100%, les fans hurlent, mais tu fais rien. C'est probablement un cryptominer cachÃ© qui mine des cryptomonnaies.\n")
        body_parts.append("**âš¡ Ã‰tape 1: VÃ©rifier le CPU usage avec Task Manager**")
        body_parts.append("Ouvre Task Manager (Ctrl+Shift+Esc) â†’ onglet 'Processus' â†’ trie par 'CPU'. Quelque chose utilise 80-100% du CPU mÃªme Ã  l'idle? Notamment si c'est un processus avec un nom random (svchost123.exe, helper.exe, service.exe - mais PAS les vrais Windows services). C'est suspecte. Clique-droit â†’ 'Ouvrir l'emplacement du fichier' â†’ note le chemin.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Chercher le processus du cryptominer**")
        body_parts.append("Les cryptominers populaires: XMRig (Monero), NBMiner, gminer, etc. Dans Task Manager, cherche les processus avec des noms suspects: 'svchost.exe' (gÃ©nÃ©ralement en C:\\Users\\Temp, PAS C:\\Windows\\System32), 'helper.exe', 'system.exe' (pas le vrai system.exe), 'updater.exe'. Utilise Process Explorer (Sysinternals) pour plus de dÃ©tails: clique-droit sur le processus â†’ 'Verify' â†’ c'est signÃ© par qui?\n")
        body_parts.append("**âš¡ Ã‰tape 3: VÃ©rifier la connexion rÃ©seau du processus (netstat)**")
        body_parts.append("Ouvre Command Prompt en admin â†’ tape 'netstat -ano'. Cherche les connexions ESTABLISHED vers des ports bizarres (ex: 3333, 9999, 14444 - ports mining pool classiques). Note le PID (Process ID) associÃ©. Puis reviens Ã  Task Manager et cherche le processus avec ce PID. Si c'est un cryptominer, il se connectera Ã  un mining pool.\n")
        body_parts.append("**âš¡ Ã‰tape 4: ArrÃªter le processus via Task Manager**")
        body_parts.append("Dans Task Manager, clique sur le processus suspect â†’ 'Fin de tÃ¢che'. Le cryptominer meurt. Mais il va probablement redÃ©marrer au reboot car il se relance depuis le registre ou un dossier au dÃ©marrage. C'est juste pour gagner du temps avant le nettoyage.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Trouver la localisation du fichier exe du cryptominer**")
        body_parts.append("D'Ã‰tape 1, tu as le chemin du fichier. GÃ©nÃ©ralement: C:\\Users\\%username%\\AppData\\Local\\[FolderName]\\malware.exe ou C:\\ProgramData\\[FolderName]\\miner.exe. Ouvre File Explorer, colle le chemin. Supprime le DOSSIER ENTIER (clique-droit â†’ Supprimer). Si tu peux pas (file locked), booter en Mode Sans Ã‰chec ou utilise Unlocker (outil Windows gratuit).\n")
        body_parts.append("**âš¡ Ã‰tape 6: Nettoyer le registre & Autoruns**")
        body_parts.append("Ouvre Autoruns (sysinternals.com) â†’ tous les onglets (Logon, Services, Scheduled Tasks, etc.). Cherche des entrÃ©es qui pointent vers le exe du cryptominer qu'on vient de supprimer. Clique-droit â†’ 'Jump to Registry Entry' â†’ REGEDIT s'ouvre. Supprime la clÃ© du registre entiÃ¨re. Si c'est un Service: services.msc â†’ supprime le service (tapez 'sc delete [ServiceName]' en Command Prompt admin).\n")
        body_parts.append("**âš¡ Ã‰tape 7: VÃ©rifier les tÃ¢ches Scheduled Tasks**")
        body_parts.append("Appuie Windows+R â†’ 'taskschd.msc' â†’ Task Scheduler Library. Cherche les tÃ¢ches bizarres nommÃ©es 'Update', 'Check System', 'Maintenance', etc. Double-clique sur une â†’ regarde l'onglet 'Actions'. Elle lance quoi? Si c'est le exe du cryptominer, clique-droit sur la tÃ¢che â†’ 'Supprimer'.\n")
        body_parts.append("**âš¡ Ã‰tape 8: Scanner avec Malwarebytes**")
        body_parts.append("Malwarebytes a une signature pour XMRig et les cryptominers populaires. Lance-le â†’ 'Scan Complet'. Attends 1-2h. Malwarebytes va trouver les rÃ©sidus du cryptominer que tu as ratÃ©s. Supprime tout.\n")
        body_parts.append("**âš¡ Ã‰tape 9: Tester les performances post-nettoyage**")
        body_parts.append("AprÃ¨s redÃ©marrage, ouvre Task Manager â†’ onglet 'Performances'. Regarde le CPU: c'est pas 80-100% idle? Ouvre HWiNFO ou CPU-Z, regarde la tempÃ©rature du CPU. Les cryptominers laissent souvent le CPU Ã  100Â°C+ dÃ©gÃ¢ts thermiques).\n")
        body_parts.append("**âš¡ Ã‰tape 10: EmpÃªcher la rÃ©installation du cryptominer**")
        body_parts.append("Le cryptominer s'installe souvent via email (attachment malveillant), torrent, ou site web suspect. Pour prÃ©venir: jamais tÃ©lÃ©charger depuis des sites suspects. Utilise uBlock Origin pour bloquer les pub malveillantes. Mets Ã  jour Windows religieusement (les exploits zero-day sont utilisÃ©s pour installer les cryptominers). Active Windows Defender en temps rÃ©el. Si tu rejoins des gaming servers ou discord, mÃ©fie-toi des fichiers qu'on te propose Ã  tÃ©lÃ©charger.")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #398 KEYLOGGER DETECTION
    if any(word in msg_lower for word in ["keylogger", "keystroke", "logger", "vol de mots de passe"]):
        body_parts.append("ğŸ›¡ï¸ #398 KEYLOGGER DETECTION & REMOVAL")
        body_parts.append("\nProblÃ¨me: Un logiciel invisible enregistre CHAQUE touche que tu appuies. Il vole tes mots de passe, donnÃ©es sensibles.\n")
        body_parts.append("**âš¡ Ã‰tape 1: ReconnaÃ®tre les signes d'un Keylogger**")
        body_parts.append("Signes possibles: accÃ¨s Ã  tes comptes internet d'un endroit inconnu (email dit 'Suspicious activity'), comptes bank vidÃ©s, emails envoyÃ©s de ton compte que t'as pas envoyÃ©s, sessions ouvertes sur des sites que tu visitais pas, retards lors de la frappe (le keylogger lag un peu). Mais attention: le vrai keylogger est TRÃˆS cachÃ©, tu peux rien remarquer.\n")
        body_parts.append("**âš¡ Ã‰tape 2: VÃ©rifier les processus actifs avec Procmon**")
        body_parts.append("TÃ©lÃ©charge Process Monitor (Sysinternals). ExÃ©cute-le en admin. Il affiche TOUS les fichiers/registre/processus accÃ©dÃ©s en temps rÃ©el. Lance-le, tape un mot de passe dans le navigateur. Procmon enregistre chaque opÃ©ration. Cherche les processus suspectes qui read ton clavier (parfois Ã§a montre les Ã©vÃ©nements de Input).\n")
        body_parts.append("**âš¡ Ã‰tape 3: Scanner avec un antivirus spÃ©cialisÃ©**")
        body_parts.append("Les keyloggers sont souvent des trojans. Lance Malwarebytes â†’ 'Scan Complet'. Attends 1-2h. Les trojan/keylogger courants: 'Trojan.Spy', 'Trojan.Psw', 'Trojan.Infostealer'. Malwarebytes devrait les dÃ©tecter.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Utiliser Spybot Search & Destroy**")
        body_parts.append("Spybot Search & Destroy est spÃ©cialisÃ© pour les spyware/keylogger. TÃ©lÃ©charge depuis safer-networking.org. ExÃ©cute â†’ 'Scan'. Spybot scanne pour les registry entries, les processus, les fichiers que les keyloggers utilisent typiquement. Supprime tout ce qu'il trouve.\n")
        body_parts.append("**âš¡ Ã‰tape 5: VÃ©rifier les extensions de navigateur**")
        body_parts.append("Beaucoup de keyloggers se dÃ©ploient comme extensions de navigateur. Ouvre Chrome/Firefox/Edge â†’ ParamÃ¨tres â†’ Extensions. Supprime TOUTE extension que tu ne reconnais pas ou qui fait peur (noms vagues, icons bizarres, zÃ©ro avis utilisateur). Cherche surtout les extensions avec 'Password', 'Save', 'Cloud', 'Sync' dans le nom.\n")
        body_parts.append("**âš¡ Ã‰tape 6: RÃ©initialiser les navigateurs complÃ¨tement**")
        body_parts.append("MÃªme aprÃ¨s suppression d'extensions, le keylogger peut avoir modifiÃ© les fichiers de config du navigateur. RÃ©initialise chaque navigateur: Chrome 'RÃ©initialiser les paramÃ¨tres'; Firefox 'RÃ©parer Firefox'; Edge 'RÃ©initialiser'. Ã‡a supprime extensions, historique, cookies, tout.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Checker les services et Startup Items**")
        body_parts.append("Appuie Windows+R â†’ msconfig â†’ Startup tab â†’ dÃ©sactive TOUT ce que tu ne reconnais pas. Aussi: services.msc â†’ cherche les services bizarres. Les keyloggers souvent font dÃ©marrer un service au boot pour rester cachÃ©. Services suspects: 'Helper Service', 'System Service', noms random. DÃ©sactive-les (clique-droit â†’ PropriÃ©tÃ©s â†’ Startup type â†’ Disabled).\n")
        body_parts.append("**âš¡ Ã‰tape 8: Changer TOUS tes mots de passe**")
        body_parts.append("Si tu soupÃ§onnais un keylogger, tes mots de passe Ã‰TAIENT compromis (au moins temporairement). Change les TOUS: email, banque, rÃ©seaux sociaux, etc. MAIS: fais-le sur un autre PC sain (pas le PC infectÃ©), ou utilise un mot de passe temporaire en attendant le nettoyage.\n")
        body_parts.append("**âš¡ Ã‰tape 9: VÃ©rifier les accÃ¨s Ã  ton compte Google/Microsoft**")
        body_parts.append("Google: myaccount.google.com â†’ 'SÃ©curitÃ©' â†’ 'Votre activitÃ© de connexion' â†’ 'Appareils et activitÃ©s' â†’ cherche les connexions d'endroits inconnus (IP, localisation bizarre). Microsoft Account: account.microsoft.com â†’ 'SÃ©curitÃ©' â†’ 'Votre rÃ©cent activitÃ©' â†’ mÃªme chose. Si tu vois des accÃ¨s suspects, clique 'Pas reconnu' â†’ Ã§a termine les sessions Ã  distance.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Installer une protection antikeylogger**")
        body_parts.append("AprÃ¨s nettoyage: ActivÃ© Windows Defender en temps rÃ©el. Certains antivirus comme Kaspersky offrent une protection 'Clavier virtuel' (virtual keyboard) pour taper les mots de passe sans un vrai clavier (empÃªche les keyloggers). Utilise un gestionnaire de mots de passe chiffrÃ© (Bitwarden, 1Password) qui peut auto-fill tes MDP sans que tu les tapes.")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #399 BOTNET INFECTION
    if any(word in msg_lower for word in ["botnet", "zombie", "botnet", "ddos infection"]):
        body_parts.append("ğŸ›¡ï¸ #399 BOTNET INFECTION DETECTION & CLEANUP")
        body_parts.append("\nProblÃ¨me: Ton PC est un 'bot' dans un rÃ©seau de milliers d'ordinateurs infectÃ©s. Ils l'utilisent pour lancer des attaques DDoS, envoyer du spam, etc.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Comprendre les botnets**")
        body_parts.append("Un botnet est un groupe de PC infectÃ©s contrÃ´lÃ©s Ã  distance par un 'botmaster'. Chaque PC (bot) exÃ©cute des commandes du botmaster: lancer attaques DDoS, envoyer du spam, installer d'autres malwares, miner des cryptomonnaies. Le traffic rÃ©seau de ton PC explose soudain sans raison. C'est criminellement grave: ton PC peut servir Ã  attaquer une banque, un hÃ´pital, etc.\n")
        body_parts.append("**âš¡ Ã‰tape 2: Monitorer le trafic rÃ©seau (netstat)**")
        body_parts.append("Ouvre Command Prompt â†’ 'netstat -ano'. Lis la liste des connexions Ã©tablies (ESTABLISHED). Cherche des connexions vers des serveurs inconnus, des ports bizarres (ex: 1337, 9999, des IPs d'un pays alÃ©atoire). Utilise WHOIS (whois [IP] dans cmd) pour identifier les serveurs. S'ils sont en Russie/Chine/pays inconnu et tu fais aucun VPN, c'est suspecte.\n")
        body_parts.append("**âš¡ Ã‰tape 3: VÃ©rifier la bande passante de ton ISP**")
        body_parts.append("Le botnet peut envoyer des milliers de paquets par seconde. Ton ISP va noterr une consommation bizarre. AccÃ¨de Ã  ton routeur (192.168.1.1) â†’ regarde le traffic. Normal c'est quelques Mo/s. Si Ã§a montre 100+ Mo/s constamment mÃªme quand tu navigues pas, c'est le botnet qui communique.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Isoler le PC du rÃ©seau (urgent!)**")
        body_parts.append("DÃ©branch le cÃ¢ble Ethernet OU dÃ©sactive la WiFi. Fais Ã§a AVANT le nettoyage complet. Ã‡a empÃªche le botnet de recevoir des ordres du botmaster et d'attaquer d'autres serveurs. Ton ISP sera reconnaissant.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Identifier l'exÃ©cutable du botnet**")
        body_parts.append("Task Manager â†’ Processus â†’ trie par CPU/Network usage. Quelque chose utilise beaucoup de bande passante? Double-clique â†’ 'Details' â†’ note le PID. Utilise 'Get-Process' en PowerShell (Get-Process | Where {$_.ID -eq PID}) pour plus de dÃ©tails. Ou Process Explorer: clique-droit â†’ 'Properties' â†’ onglet 'Strings' pour voir les chaÃ®nes de caractÃ¨res du processus (addresses IP du C&C).\n")
        body_parts.append("**âš¡ Ã‰tape 6: Nettoyer avec Malwarebytes + HitmanPro**")
        body_parts.append("Lance Malwarebytes â†’ 'Scan Complet'. Les botnets populaires (Conficker, Mirai, Emotet) ont des signatures malware. Malwarebytes devrait les dÃ©tecter. Puis utilise HitmanPro pour un deuxiÃ¨me scan cloud. HitmanPro scanne avec les derniÃ¨res donnÃ©es menaces.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Utiliser Kaspersky Rescue Disk**")
        body_parts.append("Si les scans normaux trouvent rien mais tu es sÃ»r d'avoir un botnet: Kaspersky Rescue Disk (clÃ© USB bootable). RedÃ©marre depuis la clÃ©. Kaspersky scanne AVANT que Windows charge (prÃ©-OS). Les botnets kernel-mode qui se cachent des antivirus normaux seront trouvÃ©s ici.\n")
        body_parts.append("**âš¡ Ã‰tape 8: RÃ©initialiser le routeur et les paramÃ¨tres rÃ©seau**")
        body_parts.append("Certains botnets modifient les paramÃ¨tres du routeur ou du DNS pour persister. RÃ©initialise ton routeur: boutton Reset Ã  l'arriÃ¨re (appuie 10 sec). Puis rÃ©config: change le SSID, la passphr WiFi, dÃ©sactive UPnP. Windows: ParamÃ¨tres â†’ RÃ©seau â†’ 'RÃ©initialiser le rÃ©seau' â†’ 'RÃ©initialiser maintenant'.\n")
        body_parts.append("**âš¡ Ã‰tape 9: VÃ©rifier la liste des bots connus avec online tools**")
        body_parts.append("Va sur un PC sain. Utilise Shodan (shodan.io) pour chercher ton IP publique (find it via 'what is my ip'). Cherche aussi sur Shodan des ports ouverts bizarres. Ou check si ton IP est dans une botnet list: abuseipdb.com, check-host.net. S'il y a des rapports que c'est une bot, la communautÃ© antivirus dÃ©jÃ  sait.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Reconfigurer la sÃ©curitÃ© post-nettoyage**")
        body_parts.append("AprÃ¨s nettoyage, reste prudent: Windows Defender temps rÃ©el ON. Utilise un VPN si tu dois vraiment faire du torrent (mÃªme si c'est la source du botnet). Mets Ã  jour religieusement. Jamais ouvre de piÃ¨ces jointes emails. Et surtout: change les mots de passe de tous tes comptes importants (email, banque, rÃ©seaux). Les botnets passent aussi les donnÃ©es volÃ©es (keylogger) Ã  leurs operateurs.")
        return "\n".join(body_parts)

    # ğŸ›¡ï¸ #400 WINDOWS DEFENDER COMPLETE SCAN
    if any(word in msg_lower for word in ["windows defender", "scan complet", "complete scan", "defender"]):
        body_parts.append("ğŸ›¡ï¸ #400 WINDOWS DEFENDER SCAN COMPLET - GUIDE DÃ‰TAILLÃ‰")
        body_parts.append("\nProblÃ¨me: SoupÃ§on de malware gÃ©nÃ©ral. Besoin d'un scan antivirus complÃ¨te pour checker.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Ouvrir Windows SÃ©curitÃ© (Defender)**")
        body_parts.append("Clique Windows + I (ParamÃ¨tres) â†’ 'SÃ©curitÃ© Windows' â†’ 'Gestion des menaces'. Ou tape 'Defender' dans la barre de recherche et ouvre 'SÃ©curitÃ© Windows'.\n")
        body_parts.append("**âš¡ Ã‰tape 2: AccÃ©der Ã  la section Analyse**")
        body_parts.append("Clique sur 'Analyse des menaces' (ou 'Scan' dans certaines versions). Tu verras 4 types: 'Analyse rapide' (5 min), 'Analyse complÃ¨te' (1-3h), 'Analyse personnalisÃ©e', 'Analyse hors ligne'.\n")
        body_parts.append("**âš¡ Ã‰tape 3: SÃ©lectionner 'Analyse ComplÃ¨te'**")
        body_parts.append("L'analyse complÃ¨te scanne TOUS les fichiers du disque dur: C:\\, fichiers cachÃ©s, archives zip, mÃ©moire RAM, secteurs de boot. C'est lent (peut prendre 2-3 heures sur un disque plein) mais c'est le plus complet.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Lancer le scan**")
        body_parts.append("Clique 'Analyser maintenant'. Windows Defender va commencer le scan. Pendant ce temps, ton PC va utiliser +50% CPU et disque (ralenti normal). Tu peux continuer Ã  utiliser l'ordinateur mais Ã§a sera lent.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Attendre la fin du scan**")
        body_parts.append("Laisse tourner. Le nombre de fichiers scannÃ©s s'affiche en bas. 'Scanning: 234,000 files'. Patience. Si c'est urgent, ferme les apps lourdes (navigateur avec 50 onglets, jeux, etc.) pour accÃ©lÃ©rer le scan.\n")
        body_parts.append("**âš¡ Ã‰tape 6: Attendre les rÃ©sultats**")
        body_parts.append("Ã€ la fin: 'Analyse complÃ¨te' avec le nombre de menaces trouvÃ©es (Threats found). ZÃ©ro menaces = tout bon (probablement). 1+ menaces = problÃ¨me dÃ©tectÃ©.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Consulter l'historique des menaces**")
        body_parts.append("Clique 'Gestion des menaces' â†’ 'Historique de la menace'. Tu verras une liste complÃ¨te: nom du malware, type (Trojan, Virus, Adware), chemin du fichier, date. Note les infos exactes.\n")
        body_parts.append("**âš¡ Ã‰tape 8: Mettre en quarantaine/Supprimer**")
        body_parts.append("Pour chaque menace dans l'historique: bouton 'Supprimer' ou 'Mettre en quarantaine'. 'Supprimer' = efface dÃ©finitivement. 'Mettre en quarantaine' = place dans une zone isolÃ©e (Windows\System32\Quarantine) sans risque. Je recommande 'Supprimer' une fois sÃ»r que c'est malware.\n")
        body_parts.append("**âš¡ Ã‰tape 9: RedÃ©marrer et relancer si menaces trouvÃ©es**")
        body_parts.append("AprÃ¨s suppression, redÃ©marre. Certains malwares restent en RAM. Un reboot + re-scan confirmera que c'est parti. Relance Defender â†’ Analyse ComplÃ¨te une deuxiÃ¨me fois.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Planifier des scans rÃ©guliers**")
        body_parts.append("Pour prÃ©vention: ParamÃ¨tres Windows SÃ©curitÃ© â†’ 'Gestion des virus et menaces' â†’ 'Analyser les paramÃ¨tres' â†’ active 'Analyse rapide pÃ©riodique' (une fois par semaine par dÃ©faut). Ã‡a lancera des scans rapides automatiquement chaque semaine.")
        return "\n".join(body_parts)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # CATÃ‰GORIE 13: LOGICIELS & APPLICATIONS (421-450)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    # ğŸ’¾ #421 PROGRAMME NE SE LANCE PAS
    if any(word in msg_lower for word in ["programme ne dÃ©marre pas", "app ne lance pas", "application freeze", "exe not starting"]):
        body_parts.append("ğŸ’¾ #421 PROGRAMME NE SE LANCE PAS - TROUBLESHOOTING")
        body_parts.append("\nProblÃ¨me: Tu cliques sur un exe ou un raccourci mais le programme refuse de se lancer.\n")
        body_parts.append("**âš¡ Ã‰tape 1: VÃ©rifier que le fichier existe rÃ©ellement**")
        body_parts.append("Clique-droit sur le raccourci â†’ PropriÃ©tÃ©s â†’ onglet 'Raccourci' â†’ 'Cible'. Le chemin existe? Souvent les raccourcis pointent vers un exe qui a Ã©tÃ© dÃ©placÃ© ou supprimÃ© (ex: C:\\Program Files\\App\\app.exe mais le fichier est en C:\\Users\\Desktop\\app.exe maintenant).\n")
        body_parts.append("**âš¡ Ã‰tape 2: Lancer en tant qu'administrateur**")
        body_parts.append("Clique-droit sur le raccourci â†’ 'ExÃ©cuter en tant qu'administrateur'. Beaucoup d'applications ont besoin des droits admin. Si Ã§a marche, la prochaine fois: clique-droit â†’ PropriÃ©tÃ©s â†’ 'AvancÃ©' â†’ coche 'ExÃ©cuter en tant qu'administrateur' â†’ OK.\n")
        body_parts.append("**âš¡ Ã‰tape 3: VÃ©rifier la compatibilitÃ© avec ton OS**")
        body_parts.append("Clique-droit sur le exe â†’ PropriÃ©tÃ©s â†’ 'CompatibilitÃ©'. Change 'Mode de compatibilitÃ©' (Windows 7/8/10 si l'app est vieille). Coche aussi 'ExÃ©cuter ce programme en mode plein Ã©cran' ou 'Mode compatibilitÃ© couleur rÃ©duit' si nÃ©cessaire. Clique OK.\n")
        body_parts.append("**âš¡ Ã‰tape 4: VÃ©rifier les dÃ©pendances (Visual C++, .NET, DirectX)**")
        body_parts.append("L'app peut manquer des dÃ©pendances. Erreur type: 'MSVCP140.dll not found'. Installe Visual C++ Redistributables: vc redist.com (tÃ©lÃ©charge tous les versions: 2015, 2017, 2019, 2022). RedÃ©marre. Relance l'app.\n")
        body_parts.append("**âš¡ Ã‰tape 5: VÃ©rifier les erreurs dans l'Event Viewer**")
        body_parts.append("Tapez 'Event Viewer' â†’ Go. Navigue vers 'Windows Logs' â†’ 'Application'. Cherche les erreurs rÃ©centes avec l'app qui ne lance pas. 'Application Error: appname.exe'. Lit le message: souvent Ã§a dit directement ce qui manque (DLL, .NET Framework).\n")
        body_parts.append("**âš¡ Ã‰tape 6: DÃ©sinstaller/RÃ©installer l'application**")
        body_parts.append("Panneau de Configuration â†’ Programmes et FonctionnalitÃ©s â†’ cherche l'app â†’ DÃ©sinstaller. RedÃ©marre. Puis rÃ©installe-la (depuis le CD/USB original ou en tÃ©lÃ©chargeant la derniÃ¨re version). Souvent l'installation est corrompue.\n")
        body_parts.append("**âš¡ Ã‰tape 7: VÃ©rifier le registre (si dÃ©sinstallation pas complÃ¨te)**")
        body_parts.append("AprÃ¨s dÃ©sinstallation, des restes restent dans le registre. Utilise CCleaner â†’ Registry â†’ Scan â†’ Clean. Ou utilise Revo Uninstaller (logiciel dÃ©diÃ©) qui fait un nettoyage plus profond.\n")
        body_parts.append("**âš¡ Ã‰tape 8: Lancer depuis Command Prompt pour voir l'erreur**")
        body_parts.append("Command Prompt â†’ navigue vers le dossier de l'app â†’ tape le nom de l'exe. Si y a une erreur, elle s'affichera Ã  l'Ã©cran. Ex: 'appname.exe' â†’ msg d'erreur indiquant exactement ce qui manque ou ce qui est cassÃ©.\n")
        body_parts.append("**âš¡ Ã‰tape 9: VÃ©rifier les permissions du dossier**")
        body_parts.append("Clique-droit sur le dossier de l'app â†’ PropriÃ©tÃ©s â†’ SÃ©curitÃ© â†’ 'AvancÃ©' â†’ cherche ton utilisateur dans la liste. Double-clique â†’ 'Modifier' â†’ coche 'ContrÃ´le total' â†’ OK â†’ Appliquer. Ã‡a donne les permissions complÃ¨tes.\n")
        body_parts.append("**âš¡ Ã‰tape 10: Utiliser Dependency Walker pour trouver les DLL manquantes**")
        body_parts.append("TÃ©lÃ©charge Dependency Walker (dependencywalker.com). Ouvre le exe de ton app avec Dependency Walker. Ã‡a affiche TOUTES les DLL requises et celles qui manquent (en rouge). Note les DLLs rouges et installe-les (Visual C++ redistributables, Windows Media Feature Pack, etc.).")
        return "\n".join(body_parts)

    # ğŸ’¾ #422 APPLICATION FREEZE AU DÃ‰MARRAGE
    if any(word in msg_lower for word in ["app freeze startup", "application freeze", "pas de rÃ©ponse", "not responding"]):
        body_parts.append("ğŸ’¾ #422 APPLICATION FREEZE AU DÃ‰MARRAGE")
        body_parts.append("\nProblÃ¨me: L'application se lance mais freezes immÃ©diatement. 'Not responding' dans Task Manager.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Tuer le processus**")
        body_parts.append("Task Manager â†’ cherche l'app â†’ clique-droit â†’ 'Fin de tÃ¢che'. Ã‡a tue l'app qui freeze.\n")
        body_parts.append("**âš¡ Ã‰tape 2: VÃ©rifier si des plugins ralentissent le dÃ©marrage**")
        body_parts.append("Certaines apps (surtout Photoshop, Audacity, etc.) chargent des plugins au startup qui peuvent freezer. Pour les apps qui le permettent: dossier plugins â†’ renomme-le en 'Plugins_backup'. Relance l'app. Si elle dÃ©marre, tu as identifiÃ© le problÃ¨me plugin.\n")
        body_parts.append("**âš¡ Ã‰tape 3: VÃ©rifier les permissions du fichier config**")
        body_parts.append("Beaucoup d'apps sauvegardent un fichier de configuration au lancement (souvent dans AppData). Si le fichier config est verrouillÃ© ou inaccessible: permissions refusÃ©es = freeze. Clique-droit sur le dossier AppData\\Roaming\\[AppName] â†’ PropriÃ©tÃ©s â†’ SÃ©curitÃ© â†’ 'AvancÃ©' â†’ donne les droits complets Ã  ton utilisateur.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Lancer en Mode CompatibilitÃ©**")
        body_parts.append("Clique-droit exe â†’ PropriÃ©tÃ©s â†’ CompatibilitÃ© â†’ change 'Mode de compatibilitÃ©' en Windows 7/8 (si app est vieille). DÃ©coche 'Plein Ã©cran'. Coche 'ExÃ©cuter en tant qu'administrateur'. Teste.\n")
        body_parts.append("**âš¡ Ã‰tape 5: VÃ©rifier l'utilisation disque pendant le freeze**")
        body_parts.append("L'app peut freezer car le disque est Ã  100% (indexation, antivirus scanning). Ouvre Task Manager â†’ Processus â†’ trie par 'Disk' usage. Si c'est une autre app qui utilise le disque, force-la Ã  stop: clique-droit â†’ 'Fin de tÃ¢che'.\n")
        body_parts.append("**âš¡ Ã‰tape 6: VÃ©rifier la mÃ©moire RAM disponible**")
        body_parts.append("Task Manager â†’ Performance â†’ RAM. Si c'est > 95%, la mÃ©moire est saturÃ©e. L'app freeze car pas assez de RAM. Ferme les autres apps. Ou ajoute de la RAM physique.\n")
        body_parts.append("**âš¡ Ã‰tape 7: DÃ©sactiver les extensions/add-ons**")
        body_parts.append("Pour Firefox, Chrome: les extensions ralentissent le dÃ©marrage. DÃ©sactive TOUTES les extensions: ParamÃ¨tres â†’ Extensions â†’ toggle off. Relance. Si Ã§a marche, active-les une par une pour identifier le coupable.\n")
        body_parts.append("**âš¡ Ã‰tape 8: VÃ©rifier le registre pour les entries corrompues**")
        body_parts.append("Utilise CCleaner â†’ Registre â†’ Scan. CCleaner trouve les entrÃ©es registre orphelines de l'app. Nettoie. Ã‡a peut dÃ©gager un bug registre qui cause le freeze.\n")
        body_parts.append("**âš¡ Ã‰tape 9: Mettre Ã  jour l'application**")
        body_parts.append("L'app est peut-Ãªtre un vieille version avec un bug freeze connu. Cherche les mises Ã  jour: ParamÃ¨tres de l'app â†’ About â†’ Check for Updates. Ou visite le site officiel et tÃ©lÃ©charge la derniÃ¨re version.\n")
        body_parts.append("**âš¡ Ã‰tape 10: RÃ©installer complÃ¨tement**")
        body_parts.append("Si rien marche: Panneau de Configuration â†’ Programmes et FonctionnalitÃ©s â†’ DÃ©sinstaller â†’ RedÃ©marrage. Utilise Revo Uninstaller pour un nettoyage registre complet. Puis rÃ©installe la derniÃ¨re version de l'app.")
        return "\n".join(body_parts)

    # ğŸ’¾ #423 DLL MANQUANTE
    if any(word in msg_lower for word in ["dll missing", "dll not found", "vcruntime140", "msvcp140"]):
        body_parts.append("ğŸ’¾ #423 DLL MANQUANTE (VCRUNTIME140, MSVCP140, ETC)")
        body_parts.append("\nProblÃ¨me: Erreur au lancement: 'vcruntime140.dll not found' ou 'msvcp140.dll not found'.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Identifier la DLL exacte manquante**")
        body_parts.append("L'erreur te dit exactement quel DLL: VCRUNTIME140.dll? MSVCP140.dll? MSVCR120.dll? D120 veut dire Visual C++ 2013, C140 = 2015. Note-le.\n")
        body_parts.append("**âš¡ Ã‰tape 2: TÃ©lÃ©charger Visual C++ Redistributable correspondant**")
        body_parts.append("Va sur microsoft.com/en-us/download/visual-cpp-redistributable. La page liste tous les versions. TÃ©lÃ©charge celle qui correspond: 2013, 2015, 2017, 2019, 2022. Attention: 32-bit vs 64-bit. Si ton app est 32-bit, tÃ©lÃ©charge Visual C++ 32-bit. Installe.\n")
        body_parts.append("**âš¡ Ã‰tape 3: Installer TOUS les versions Visual C++ Redistributables**")
        body_parts.append("Pour la sÃ©curitÃ©, installe littÃ©ralement TOUTES les versions de VC++: 2005, 2008, 2010, 2012, 2013, 2015, 2017, 2019, 2022 (32-bit ET 64-bit). Windows utilise un systÃ¨me 'side-by-side' (SXS) qui peut avoir besoin de multiples versions.\n")
        body_parts.append("**âš¡ Ã‰tape 4: RedÃ©marrer aprÃ¨s installation**")
        body_parts.append("RedÃ©marre toujours aprÃ¨s installer Visual C++. Les DLLs sont souvent en cache par Windows.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Chercher la DLL manuellement sur le systÃ¨me**")
        body_parts.append("Si le VC++ install ne rÃ¨gle pas: Command Prompt â†’ 'where vcruntime140.dll'. Windows cherchera la DLL. Si elle existe: 'C:\\Program Files\\...' mais l'app regarde ailleurs, tu peux copier la DLL dans le dossier de l'app (mÃªme dossier que le exe).\n")
        body_parts.append("**âš¡ Ã‰tape 6: VÃ©rifier que Windows Update est Ã  jour**")
        body_parts.append("Windows Update peut installer les 'System DLLs' (MSVCRT.dll, kernel32.dll, etc.). Va ParamÃ¨tres â†’ Mise Ã  jour â†’ vÃ©rifier les mises Ã  jour. Certains patches Windows incluent les VC++ runtime updates.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Utiliser Dependency Walker pour voir toutes les DLLs requises**")
        body_parts.append("TÃ©lÃ©charge Dependency Walker. Ouvre le exe de ton app. Il affiche toutes les DLLs en rouge (manquantes) et vert (trouvÃ©es). Chaque DLL rouge, installe-la (gÃ©nÃ©ralement c'est Visual C++ ou .NET Framework).\n")
        body_parts.append("**âš¡ Ã‰tape 8: Installer .NET Framework si nÃ©cessaire**")
        body_parts.append("Si l'erreur mentionne 'mscoree.dll' ou 'mscorwks.dll': c'est .NET Framework qui manque. Va microsoft.com â†’ '.NET Framework download' â†’ installe la derniÃ¨re version (4.8.2 en 2024). Certaines apps vieilles demandent .NET 3.5: Panneau de Configuration â†’ Programmes â†’ 'Activer ou dÃ©sactiver les fonctionnalitÃ©s Windows' â†’ coche '.NET Framework 3.5'.\n")
        body_parts.append("**âš¡ Ã‰tape 9: VÃ©rifier les fichiers systÃ¨me corrompus**")
        body_parts.append("Command Prompt as Admin â†’ 'sfc /scannow'. System File Checker vÃ©rifie l'intÃ©gritÃ© de toutes les DLLs systÃ¨me et les rÃ©pare. Peut prendre 30 min. Souvent il dÃ©couvre des DLLs corrompues qu'il va rÃ©parer.\n")
        body_parts.append("**âš¡ Ã‰tape 10: RÃ©installer l'application**")
        body_parts.append("AprÃ¨s tous les installations Visual C++, .NET, SFC scan: rÃ©installe l'app qui avait l'erreur DLL. Elle trouvera toutes les DLLs maintenant.")
        return "\n".join(body_parts)

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # CONTINUITÃ‰: CATÃ‰GORIES 14-16 (GAMING, STREAMING, OVERCLOCKING)
    # (Les autres scÃ©narios 424-500 seraient gÃ©nÃ©rÃ©s de maniÃ¨re similaire)
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    # Placeholder pour les scÃ©narios 424-450 (mÃªme structure)
    if any(word in msg_lower for word in [".net framework", "directx", "java jre", "redistributables"]):
        body_parts.append("ğŸ’¾ #424-426 DÃ‰PENDANCES LOGICIELLES (.NET, DirectX, Java)")
        body_parts.append("\nProblÃ¨me: L'application demande une dÃ©pendance manquante.\n")
        body_parts.append("**Solutions rapides:**\n")
        body_parts.append("- .NET Framework: microsoft.com â†’ .NET Framework download â†’ version correspondante (3.5, 4.8, etc.)\n")
        body_parts.append("- DirectX: microsoft.com â†’ DirectX End-User Runtime Web Installer\n")
        body_parts.append("- Java: java.com â†’ Download â†’ JRE version requise\n")
        body_parts.append("- Toutes les redistributables Visual C++: microsoft.com â†’ Visual C++ Redistributable â†’ install toutes versions")
        return "\n".join(body_parts)

    # ğŸ® #451-470 GAMING PLATFORMS
    if any(word in msg_lower for word in ["steam", "epic games", "origin", "battle.net", "ubisoft", "gog", "gaming launcher"]):
        body_parts.append("ğŸ® #451-470 GAMING LAUNCHERS & PLATFORMS ISSUES")
        body_parts.append("\nProblÃ¨me: Launcher Steam/Epic/Origin/Battle.net ne fonctionne pas bien.\n")
        body_parts.append("**âš¡ Ã‰tape 1: VÃ©rifier la connexion internet**")
        body_parts.append("Les launchers ont BESOIN d'internet. Test: ping google.com. ConnectÃ©?\n")
        body_parts.append("**âš¡ Ã‰tape 2: VÃ©rifier les paramÃ¨tres du pare-feu**")
        body_parts.append("Windows Firewall peut bloquer les launchers. Windows Defender Firewall â†’ 'Permettre une app via le pare-feu' â†’ cherche Steam/Epic/Origin â†’ coche 'Public' + 'Private'.\n")
        body_parts.append("**âš¡ Ã‰tape 3: Vider le cache du launcher**")
        body_parts.append("Chaque launcher a un dossier cache. Steam: C:\\Program Files (x86)\\Steam\\appcache â†’ supprime. Epic: C:\\Program Files\\Epic Games\\Launcher\\Engine\\Intermediate\\Build â†’ supprime. Relance.\n")
        body_parts.append("**âš¡ Ã‰tape 4: VÃ©rifier les mises Ã  jour**")
        body_parts.append("Chaque launcher a sa propre mise Ã  jour. RedÃ©marre chaque launcher: souvent Ã§a trigger une mise Ã  jour auto.\n")
        body_parts.append("**âš¡ Ã‰tape 5: RÃ©installer si tout Ã©choue**")
        body_parts.append("DÃ©sinstalle complÃ¨tement (Panneau Control â†’ Programmes â†’ DÃ©sinstaller). RÃ©installe la derniÃ¨re version depuis le site officiel. C'est souvent plus rapide que troubleshoot.\n")
        body_parts.append("**âš¡ Ã‰tapes 6-10: Check credentials, antivirus, administrator permissions, graphics drivers, and reinstall launcher**")
        return "\n".join(body_parts)

    # ğŸ“¡ #471-490 STREAMING & RECORDING
    if any(word in msg_lower for word in ["obs", "streaming", "recording", "encoding", "bitrate", "green screen", "capture", "twitch", "youtube"]):
        body_parts.append("ğŸ“¡ #471-490 STREAMING & RECORDING (OBS, Ã‰LGATO, TWITCH)")
        body_parts.append("\nProblÃ¨me: OBS stream lag, dropped frames, audio desync.\n")
        body_parts.append("**âš¡ Ã‰tape 1: VÃ©rifier les paramÃ¨tres d'encodage OBS**")
        body_parts.append("OBS Settings â†’ Output â†’ Encoder: x264 (CPU) vs NVENC (GPU). Pour streaming: si CPU est faible, utilise NVENC (RTX card). Bitrate: 1080p@60fps = 6000-8000 kbps minimum. 720p@60fps = 4000-6000 kbps.\n")
        body_parts.append("**âš¡ Ã‰tape 2: VÃ©rifier l'Internet upload**")
        body_parts.append("Speedtest.net â†’ mesure la vitesse upload. Pour streaming 6000 kbps, tu as besoin >10 Mbps upload (recommandÃ©: 15+ Mbps). Moins = dropped frames. Passe de WiFi Ã  CÃ¢ble Ethernet si possible.\n")
        body_parts.append("**âš¡ Ã‰tape 3: RÃ©duire la rÃ©solution/FPS si lag**")
        body_parts.append("Au lieu de 1080p@60fps, utilise 720p@30fps. OBS â†’ vidÃ©o â†’ base rÃ©solution/output resolution. Moins de donnÃ©es = moins de lag. Tu peux toujours upscale pour une bonne qualitÃ©.\n")
        body_parts.append("**âš¡ Ã‰tape 4: Utiliser le GPU pour l'encoding au lieu du CPU**")
        body_parts.append("NVIDIA RTX card: utilise NVENC (hardware encoder). AMD: utilise VCE. Intel: utilise Quick Sync. Ã‡a free up le CPU pour le jeu/apps.\n")
        body_parts.append("**âš¡ Ã‰tape 5: Choisir le bon serveur Twitch/YouTube**")
        body_parts.append("Twitch: plusieurs serveurs ingest par rÃ©gion. Twitch Creator Camp â†’ choose serveur avec le meilleur ping. Plus proche = moins latency.\n")
        body_parts.append("**âš¡ Ã‰tapes 6-10: Check audio sync (sync offset), disable OBS plugins, upgrade internet, clean obs cache, check GPU usage, and test with lower bitrate**")
        return "\n".join(body_parts)

    # ğŸ”§ #491-500 OVERCLOCKING AVANCÃ‰
    if any(word in msg_lower for word in ["delid", "voltage curve", "overclock", "ptl", "tdc", "edc", "silicon lottery", "clock stretching", "loadline"]):
        body_parts.append("ğŸ”§ #491-500 OVERCLOCKING AVANCÃ‰ (DELID, VOLTAGE CURVE, LIMITS)")
        body_parts.append("\nProblÃ¨me: Overclocking avancÃ© + tuning tension voltage.\n")
        body_parts.append("**âš¡ Ã‰tape 1: Comprendre Delid (CPU)**")
        body_parts.append("Delid = retirer l'IHS (heatspreader) du CPU pour rÃ©appliquer une pÃ¢te thermique meilleure directement sur le die. RÃ©duit temps de 10-20Â°C. RisquÃ©: tu peux endommager le CPU. Utilise un delid tool spÃ©cifique (Rockit 88, pince spÃ©ciale). AprÃ¨s: pÃ¢te thermique de haute qualitÃ© (Thermal Grizzly Kryonaut, Noctua NT-H1).\n")
        body_parts.append("**âš¡ Ã‰tape 2: GPU Voltage Curve (MSI Afterburner)**")
        body_parts.append("Afterburner â†’ curve editor â†’ tu as un graphe voltage vs frequency. Au lieu de fixed voltage (stable mais chaud), tu crÃ©e une courbe custom (ex: 1950 MHz @ 0.9V au lieu de 1.05V). RÃ©duit le heat, augmente la frÃ©quence safe. Benchmark avec Furmark aprÃ¨s chaque ajustement.\n")
        body_parts.append("**âš¡ Ã‰tape 3: Memory Controller Voltage Tuning (RAM OC)**")
        body_parts.append("VDDG (AMD Ryzen): tension pour le memory controller. Augmenter VDDG 0.05V Ã  la fois = plus stable aux hautes frÃ©quences RAM. Tester avec MemTest86 aprÃ¨s chaque ajustement. Limite: ne dÃ©passe pas 1.4V (dÃ©gÃ¢ts thermiques).\n")
        body_parts.append("**âš¡ Ã‰tape 4: PLL Voltage (Intel)**")
        body_parts.append("PLL (Phase-Locked Loop): tension pour la gÃ©nÃ©ration de clock. Augmenter PLL 0.02V Ã  la fois pour overclock stable. RisquÃ©: trop haut = CPU degradation. Benchmark: Intel Cinebench R23 multi-core (10min stable = OK).\n")
        body_parts.append("**âš¡ Ã‰tape 5: Loadline Calibration (LLC) Levels**")
        body_parts.append("BIOS setting: CPU LLC (niveau 1-5 typiquement). LLC = compensation voltage sous charge. Niveau 1 = LLC faible (voltage droops plus), Niveau 5 = LLC fort (voltage stable mais trop haut). Optimal pour overclock: Niveau 2-3. Teste: benchmark, regarde voltage avec HWiNFO. Doit Ãªtre stable.\n")
        body_parts.append("**âš¡ Ã‰tape 6: DÃ©tecter Clock Stretching**")
        body_parts.append("Clock stretching = CPU prÃ©tend Ãªtre Ã  5.0 GHz mais vraiment c'est 4.2 GHz (throttling cachÃ©). Utilise CPU-Z â†’ regarde la frÃ©quence pendant le benchmark. Si frÃ©quence affichÃ©e ne match pas ton setting OC, c'est clock stretching. Cause: voltage trop faible, tempÃ©rature trop haute, LLC mal config.\n")
        body_parts.append("**âš¡ Ã‰tape 7: Intel Power Limits (PL1/PL2/Tau)**")
        body_parts.append("BIOS â†’ Power Management â†’ PL1 (long-term limit, ex: 95W) / PL2 (short-term, ex: 250W) / Tau (time before throttle). PL1 contrÃ´le la tempÃ©rature moyenne long-term. Augmenter PL1/PL2 = moins throttle, plus chaud. Configuration gaming: PL1=125W, PL2=190W, Tau=56 secondes (dÃ©faut). Pour max performance: Disable power limits (gÃ¨re la chaleur avec le cooler).\n")
        body_parts.append("**âš¡ Ã‰tape 8: AMD PPT/TDC/EDC Limits**")
        body_parts.append("BIOS â†’ Ryzen â†’ PBO â†’ PPT/TDC/EDC sliders. PPT (Package Power Tracking) = total package power; TDC = core current; EDC = SoC current. Augmenter = plus de power pour OC. Defaults pour Ryzen 9000 series: PPT=230W, TDC=140A, EDC=85A. Pour OC agressif: PPT=280W, TDC=160A, EDC=100A. ATTENTION: peut nÃ©cessiter meilleur PSU.\n")
        body_parts.append("**âš¡ Ã‰tape 9: Benchmark de stabilitÃ© avancÃ©e**")
        body_parts.append("Test suite: Cinebench R23 (10min), MemTest86 (2000%), Prime95 (8h), OCCT (3h GPU). Si tout passe sans erreurs/crash: tu es stable. Une erreur MemTest = RAM instable (augmente voltage/latencies). Une crash Cinebench = CPU instable (augmente voltage/vÃ©rifie cooling).\n")
        body_parts.append("**âš¡ Ã‰tape 10: Silicon Lottery & Bin Quality**")
        body_parts.append("Pas tous les CPUs sont crÃ©Ã©s Ã©gaux. Certains 'chips' peuvent overclock Ã  6.0 GHz @ 1.3V (golden bin), d'autres crash Ã  5.2 GHz @ 1.35V (poor bin). C'est la 'silicon lottery'. Tu peux pas savoir jusqu'Ã  que tu test. Pour maxer les chances: benchmarks publics de ton CPU exact (cherche 'i9-14900K OC results' sur Reddit/forums). Compare avec d'autres, ajuste settings selon.")
        return "\n".join(body_parts)

    return None


# Export de la fonction
if __name__ == "__main__":
    # Test simple
    test_messages = [
        "virus dÃ©tectÃ© sur mon pc",
        "mon pc mine du crypto",
        "programme ne dÃ©marre pas",
        "streaming obs lag",
        "delid cpu"
    ]

    for msg in test_messages:
        result = handle_scenarios_391_500(msg.lower())
        if result:
            print(f"\n{'='*80}\nQuery: {msg}\n{'='*80}\n")
            print(result[:500] + "..." if len(result) > 500 else result)
        else:
            print(f"No match for: {msg}")
